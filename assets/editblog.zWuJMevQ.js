import{ay as t,z as e,T as i,az as n,E as s,G as r,aA as a,aB as l,U as h,aC as o}from"./index-JdodzDdN.js";import{g as u}from"./devibeans.CyGp03w2.js";let c=null;async function f(t,i){if(!document.startViewTransition)return void e({url:"/pages/code/code?id="+t.id});c&&(c.active=!1),c=t,t.active=!0;const n=document.startViewTransition((()=>{e({url:"/pages/code/code?id="+t.id})}));try{await n.updateCallbackDone,await n.ready,await n.finished;n.skipTransition()}catch(s){}}function p(){t("navigateBack",{invoke(t){document.startViewTransition((()=>{}))},success(t){},fail(t){console.log("interceptor-fail",t)},complete(t){}})}var g,v;var d=m;function m(t){var e=this;if(e instanceof m||(e=new m),e.tail=null,e.head=null,e.length=0,t&&"function"==typeof t.forEach)t.forEach((function(t){e.push(t)}));else if(arguments.length>0)for(var i=0,n=arguments.length;i<n;i++)e.push(arguments[i]);return e}function y(t,e,i){var n=e===t.head?new b(i,null,e,t):new b(i,e,e.next,t);return null===n.next&&(t.tail=n),null===n.prev&&(t.head=n),t.length++,n}function w(t,e){t.tail=new b(e,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function x(t,e){t.head=new b(e,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function b(t,e,i,n){if(!(this instanceof b))return new b(t,e,i,n);this.list=n,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,i?(i.prev=this,this.next=i):this.next=null}m.Node=b,m.create=m,m.prototype.removeNode=function(t){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,i=t.prev;return e&&(e.prev=i),i&&(i.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=i),t.list.length--,t.next=null,t.prev=null,t.list=null,e},m.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}},m.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}},m.prototype.push=function(){for(var t=0,e=arguments.length;t<e;t++)w(this,arguments[t]);return this.length},m.prototype.unshift=function(){for(var t=0,e=arguments.length;t<e;t++)x(this,arguments[t]);return this.length},m.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}},m.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}},m.prototype.forEach=function(t,e){e=e||this;for(var i=this.head,n=0;null!==i;n++)t.call(e,i.value,n,this),i=i.next},m.prototype.forEachReverse=function(t,e){e=e||this;for(var i=this.tail,n=this.length-1;null!==i;n--)t.call(e,i.value,n,this),i=i.prev},m.prototype.get=function(t){for(var e=0,i=this.head;null!==i&&e<t;e++)i=i.next;if(e===t&&null!==i)return i.value},m.prototype.getReverse=function(t){for(var e=0,i=this.tail;null!==i&&e<t;e++)i=i.prev;if(e===t&&null!==i)return i.value},m.prototype.map=function(t,e){e=e||this;for(var i=new m,n=this.head;null!==n;)i.push(t.call(e,n.value,this)),n=n.next;return i},m.prototype.mapReverse=function(t,e){e=e||this;for(var i=new m,n=this.tail;null!==n;)i.push(t.call(e,n.value,this)),n=n.prev;return i},m.prototype.reduce=function(t,e){var i,n=this.head;if(arguments.length>1)i=e;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");n=this.head.next,i=this.head.value}for(var s=0;null!==n;s++)i=t(i,n.value,s),n=n.next;return i},m.prototype.reduceReverse=function(t,e){var i,n=this.tail;if(arguments.length>1)i=e;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");n=this.tail.prev,i=this.tail.value}for(var s=this.length-1;null!==n;s--)i=t(i,n.value,s),n=n.prev;return i},m.prototype.toArray=function(){for(var t=new Array(this.length),e=0,i=this.head;null!==i;e++)t[e]=i.value,i=i.next;return t},m.prototype.toArrayReverse=function(){for(var t=new Array(this.length),e=0,i=this.tail;null!==i;e++)t[e]=i.value,i=i.prev;return t},m.prototype.slice=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var i=new m;if(e<t||e<0)return i;t<0&&(t=0),e>this.length&&(e=this.length);for(var n=0,s=this.head;null!==s&&n<t;n++)s=s.next;for(;null!==s&&n<e;n++,s=s.next)i.push(s.value);return i},m.prototype.sliceReverse=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var i=new m;if(e<t||e<0)return i;t<0&&(t=0),e>this.length&&(e=this.length);for(var n=this.length,s=this.tail;null!==s&&n>e;n--)s=s.prev;for(;null!==s&&n>t;n--,s=s.prev)i.push(s.value);return i},m.prototype.splice=function(t,e,...i){t>this.length&&(t=this.length-1),t<0&&(t=this.length+t);for(var n=0,s=this.head;null!==s&&n<t;n++)s=s.next;var r=[];for(n=0;s&&n<e;n++)r.push(s.value),s=this.removeNode(s);null===s&&(s=this.tail),s!==this.head&&s!==this.tail&&(s=s.prev);for(n=0;n<i.length;n++)s=y(this,s,i[n]);return r},m.prototype.reverse=function(){for(var t=this.head,e=this.tail,i=t;null!==i;i=i.prev){var n=i.prev;i.prev=i.next,i.next=n}return this.head=e,this.tail=t,this};try{(v?g:(v=1,g=function(t){t.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}))(m)}catch(X){}const A=d,S=Symbol("max"),k=Symbol("length"),T=Symbol("lengthCalculator"),E=Symbol("allowStale"),P=Symbol("maxAge"),R=Symbol("dispose"),O=Symbol("noDisposeOnSet"),N=Symbol("lruList"),C=Symbol("cache"),D=Symbol("updateAgeOnGet"),j=()=>1;const L=(t,e,i)=>{const n=t[C].get(e);if(n){const e=n.value;if(q(t,e)){if(G(t,n),!t[E])return}else i&&(t[D]&&(n.value.now=Date.now()),t[N].unshiftNode(n));return e.value}},q=(t,e)=>{if(!e||!e.maxAge&&!t[P])return!1;const i=Date.now()-e.now;return e.maxAge?i>e.maxAge:t[P]&&i>t[P]},B=t=>{if(t[k]>t[S])for(let e=t[N].tail;t[k]>t[S]&&null!==e;){const i=e.prev;G(t,e),e=i}},G=(t,e)=>{if(e){const i=e.value;t[R]&&t[R](i.key,i.value),t[k]-=i.length,t[C].delete(i.key),t[N].removeNode(e)}};class V{constructor(t,e,i,n,s){this.key=t,this.value=e,this.length=i,this.now=n,this.maxAge=s||0}}const $=(t,e,i,n)=>{let s=i.value;q(t,s)&&(G(t,i),t[E]||(s=void 0)),s&&e.call(n,s.value,s.key,t)};const z="https://fc-mp-dd639089-35cb-4e29-a250-f4786c8dcafd.next.bspapp.com";let H="APP-PLUS";H="H5";const M=new(u(class{constructor(t){if("number"==typeof t&&(t={max:t}),t||(t={}),t.max&&("number"!=typeof t.max||t.max<0))throw new TypeError("max must be a non-negative number");this[S]=t.max||1/0;const e=t.length||j;if(this[T]="function"!=typeof e?j:e,this[E]=t.stale||!1,t.maxAge&&"number"!=typeof t.maxAge)throw new TypeError("maxAge must be a number");this[P]=t.maxAge||0,this[R]=t.dispose,this[O]=t.noDisposeOnSet||!1,this[D]=t.updateAgeOnGet||!1,this.reset()}set max(t){if("number"!=typeof t||t<0)throw new TypeError("max must be a non-negative number");this[S]=t||1/0,B(this)}get max(){return this[S]}set allowStale(t){this[E]=!!t}get allowStale(){return this[E]}set maxAge(t){if("number"!=typeof t)throw new TypeError("maxAge must be a non-negative number");this[P]=t,B(this)}get maxAge(){return this[P]}set lengthCalculator(t){"function"!=typeof t&&(t=j),t!==this[T]&&(this[T]=t,this[k]=0,this[N].forEach((t=>{t.length=this[T](t.value,t.key),this[k]+=t.length}))),B(this)}get lengthCalculator(){return this[T]}get length(){return this[k]}get itemCount(){return this[N].length}rforEach(t,e){e=e||this;for(let i=this[N].tail;null!==i;){const n=i.prev;$(this,t,i,e),i=n}}forEach(t,e){e=e||this;for(let i=this[N].head;null!==i;){const n=i.next;$(this,t,i,e),i=n}}keys(){return this[N].toArray().map((t=>t.key))}values(){return this[N].toArray().map((t=>t.value))}reset(){this[R]&&this[N]&&this[N].length&&this[N].forEach((t=>this[R](t.key,t.value))),this[C]=new Map,this[N]=new A,this[k]=0}dump(){return this[N].map((t=>!q(this,t)&&{k:t.key,v:t.value,e:t.now+(t.maxAge||0)})).toArray().filter((t=>t))}dumpLru(){return this[N]}set(t,e,i){if((i=i||this[P])&&"number"!=typeof i)throw new TypeError("maxAge must be a number");const n=i?Date.now():0,s=this[T](e,t);if(this[C].has(t)){if(s>this[S])return G(this,this[C].get(t)),!1;const r=this[C].get(t).value;return this[R]&&(this[O]||this[R](t,r.value)),r.now=n,r.maxAge=i,r.value=e,this[k]+=s-r.length,r.length=s,this.get(t),B(this),!0}const r=new V(t,e,s,n,i);return r.length>this[S]?(this[R]&&this[R](t,e),!1):(this[k]+=r.length,this[N].unshift(r),this[C].set(t,this[N].head),B(this),!0)}has(t){if(!this[C].has(t))return!1;const e=this[C].get(t).value;return!q(this,e)}get(t){return L(this,t,!0)}peek(t){return L(this,t,!1)}pop(){const t=this[N].tail;return t?(G(this,t),t.value):null}del(t){G(this,this[C].get(t))}load(t){this.reset();const e=Date.now();for(let i=t.length-1;i>=0;i--){const n=t[i],s=n.e||0;if(0===s)this.set(n.k,n.v);else{const t=s-e;t>0&&this.set(n.k,n.v,t)}}}prune(){this[C].forEach(((t,e)=>L(this,e,!1)))}}))({max:500,maxAge:864e5}),U=(i("api-cache")||[]).filter((t=>t.e>Date.now()));U&&M.load(U);const I=t=>{const u=`${t.url}|${JSON.stringify(t.data)}`,{useCache:c=!0}=t;return c&&M.has(u)?Promise.resolve(M.get(u)):new Promise((async(f,p)=>{t=function(t){let e={"access-token":i("access-token")},n=/(http|https):\/\/\S*/;t.url=n.test(t.url)?t.url:z+t.url,t.method=t.method??"POST",t.header=t.header??{},t.data=t.data??{},t.config=t.config??{},t.config.showLoading&&s({title:t.config.loadtext?t.config.loadtext:"数据加载中"});let r={"content-type":"application/json",platform:"H5",...e};return t.header=Object.assign(r,t.header),t}(t);let g=n({url:t.url,method:t.method,data:t.data,header:t.header,complete:async i=>{i=await async function(t,i){i.config.showLoading&&r();if(i.config.catchAll)return Promise.resolve(t);if("request:fail abort"==t.errMsg)return Promise.resolve(t);if(500==t.statusCode)return a({title:"服务器发生错误",mask:!0,duration:1500,icon:"none"}),Promise.reject(t);if(200!=t.statusCode)return Promise.reject(t);t.data&&401===t.data.code&&(console.log("未登录"),function(t,i=!1){let n=l(),s="",r=n[n.length-1];r&&(s=r.route,i&&h("loginRedirect",r.$page.fullPath));if("/"+s==t)return;if(J.curRoute)return;J.curRoute=!0,e({url:t,success(){J.curRoute=!1},fail(){o({url:t,complete(){J.curRoute=!1}})}})}("/pagesB/login/login",!0));return Promise.resolve(t.data)}(i,t),c&&(M.set(u,i),(t=>{const e=t.dump();console.log(e),h("api-cache",e)})(M)),f(i)}});t.config.requestTask&&t.config.requestTask(g)})).catch((t=>(console.log(t),t)))};let J={};const F=t=>I({method:"POST",url:"/getIndex",data:t}).catch((t=>(console.log(t),t))),K=t=>I({method:"POST",url:"/getArticle",data:t}).catch((t=>(console.log(t),t))),Q=t=>I({method:"POST",url:"/getArticleDetail",data:t}).catch((t=>(console.log(t),t))),W=t=>I({method:"POST",url:"/delArticle",data:t}).catch((t=>(console.log(t),t)));export{Q as a,p as b,K as c,W as d,f as g,F as s};
